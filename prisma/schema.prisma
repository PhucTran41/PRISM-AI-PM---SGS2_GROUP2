generator client {
  provider = "prisma-client"
  output   = "./generated"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String     @id @default(uuid())
  username    String     @unique
  displayName String   
  email       String     @unique
  password    String
  avatarUrl   String
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  googleAuth  Boolean    @default(false)
  githubAuth  Boolean    @default(false)
  githubId    String?    @unique

  files     File[]

  @@map("users")

  @@index([email])
  @@index([username])
}

model File {
  id         String   @id @default(cuid())
  key        String   @unique // R2 object key
  fileName   String   // Original file name
  fileSize   BigInt   // File size in bytes
  mimeType   String   // MIME type
  bucket     String   // R2 bucket name
  userId     String?  // Optional user ID
  uploadedAt DateTime @default(now())
  
  user       User?    @relation(fields: [userId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([uploadedAt])
  @@index([mimeType])
  @@map("files")
}

model EmailVerificationCode {
  id         String    @id @default(uuid())
  email      String    @unique
  code       String
  expires    DateTime
  verified   Boolean   @default(false)
  created_at DateTime  @default(now())
}
